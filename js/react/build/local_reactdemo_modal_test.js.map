{
  "version": 3,
  "sources": ["../../../../../lib/js/react/src/profiler.ts", "../src/helper.ts", "../src/local_reactdemo_modal_test.tsx"],
  "sourcesContent": ["import { createElement, Profiler } from \"react\";\nimport type { ComponentType, ProfilerOnRenderCallback } from \"react\";\n\nexport const isProfilerEnabled = (): boolean => {\n    return Boolean(window.M?.cfg?.reactprofiling);\n};\n\nexport const onRenderCallback: ProfilerOnRenderCallback = (\n    id,\n    phase,\n    actualDuration,\n    baseDuration,\n    startTime,\n    commitTime\n) => {\n    if (!isProfilerEnabled()) return;\n\n    console.groupCollapsed(`[${phase}] ${id} - ${actualDuration.toFixed(2)}ms`);\n\n    console.table({\n        Component: id,\n        Phase: phase,\n        \"Duration (ms)\": actualDuration.toFixed(2),\n        \"Base Duration (ms)\": baseDuration.toFixed(2),\n        \"Start Time\": startTime.toFixed(2),\n        \"Commit Time\": commitTime.toFixed(2),\n    });\n\n    if (actualDuration > 16) {\n        console.warn(\n            `Slow render: ${actualDuration.toFixed(2)}ms (target: <16ms for 60fps)`\n        );\n    }\n\n    if (actualDuration > 50) {\n        console.error(\n            `Very slow render: ${actualDuration.toFixed(\n                2\n            )}ms - Consider optimization!`\n        );\n    }\n\n    console.groupEnd();\n};\n\nexport const getProfilerCallback = (): ProfilerOnRenderCallback | undefined => {\n    return isProfilerEnabled() ? onRenderCallback : undefined;\n};\n\n/**\n * Wraps a component with Profiler in dev mode.\n *\n * @example\n * ```tsx\n * import { withProfiler } from '@moodle/core/profiler';\n *\n * function MyComponent(props) {\n *   return <div>...</div>;\n * }\n *\n * export default withProfiler(MyComponent, 'MyComponent');\n * ```\n */\nexport function withProfiler<P extends object>(\n    Component: ComponentType<P>,\n    id?: string\n): ComponentType<P> {\n    if (!isProfilerEnabled()) {\n        return Component;\n    }\n\n    const componentId =\n        id || Component.displayName || Component.name || \"Component\";\n\n    const ProfiledComponent = (props: P) =>\n        createElement(\n            Profiler,\n            { id: componentId, onRender: onRenderCallback },\n            createElement(Component, props)\n        );\n\n    ProfiledComponent.displayName = `withProfiler(${componentId})`;\n\n    return ProfiledComponent;\n}\n", "\n/**\n * Loads a requested module.\n *\n * @param {string} mod is module name.\n * @returns {Promise}\n */\nexport default function requireAmd(mod: string) {\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    return new Promise<any>((resolve, reject) => {\n        // Use any to avoid TypeScript errors with require.\n        (require as any)([mod], resolve, reject);\n    });\n}", "import React from \"react\";\nimport {Button} from \"@moodlehq/design-system\";\nimport { withProfiler } from \"@moodle/lms/core/profiler\";\nimport requireAmd from './helper';\n\n/**\n *\n * @param {string} key is a string key\n * @param {string} component is a component name\n * @param {Array} params is array of data\n * @returns {Promise}\n */\nasync function getString(key, component, params = {}) {\n  const str = await requireAmd(\"core/str\");\n  return str.get_string(key, component, params);\n}\n\n/**\n * Loads a modal form.\n *\n * @param {object} props object properties sent from renderer\n * @param {Event} event\n */\nconst loadModalForm = async(props, event) => {\n  event?.preventDefault();\n  const ModalForm = await requireAmd(\"core_form/modalform\");\n  const modalHeader = await getString(\"modal_header\", \"local_reactdemo\");\n  const form = new ModalForm({\n    formClass: \"local_reactdemo\\\\simple2complex_form\",\n    args: { contextid: props.contextid },\n    modalConfig: { title: modalHeader },\n    returnFocus: event?.currentTarget ?? null,\n  });\n  form.show();\n};\n\n/**\n * Renders react components.\n * @param {object} props\n * @returns A JSX.Element representing the component UI\n */\nfunction App(props) {\n  const [tick, setTick] = React.useState(0);\n  window.console.log(tick);\n  React.useEffect(() => {\n    setTimeout(() => setTick(t => t + 1), 500);\n  }, []);\n\n  const [label, setLabel] = React.useState(\"\");\n\n  React.useEffect(() => {\n    async function load() {\n      const text = await getString(\"text\", \"local_reactdemo\");\n      setLabel(text);\n    }\n\n    load().catch((error) =>\n      window.console.error(\"Failed to load string\", error)\n    );\n  }, []);\n\n  return (\n    <div>\n      {label || \"Hello from my new file\"}\n      <br />\n      <Button label=\"Modal form?\" onClick={() => loadModalForm(props)} />\n    </div>\n  );\n}\n\n/**\n * Export the App.\n * @param {object} props\n * @returns A JSX.Element representing the component UI\n */\nexport default function init(props = {}) {\n  const ProfiledApp = withProfiler(App, \"App\");\n  return <ProfiledApp {...props} />;\n}"],
  "mappings": "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",
  "names": []
}
